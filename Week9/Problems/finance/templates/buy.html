{% extends "layout.html" %}
{% block title %}
    Buy
{% endblock %}

{% block head %}
  <title>Confirmation Modal Example</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
{% endblock %}

{% block main %}
  <form id="buy-form" action="/buy" method="post">
    <div class="mb-3">
        <input autofocus class="form-control mx-auto w-auto" name="symbol" placeholder="Symbol" type="text">
    </div>
    <div class="mb-3">
        <input autofocus class="form-control mx-auto w-auto" name="shares" placeholder="Shares" type="text">
    </div>
    <br>
    <button id="modalButton" type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#confirmModal">
      Purchase
    </button>
  </form>

  <div class="modal fade" id="confirmModal" tabindex="-1" aria-labelledby="confirmModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="confirmModalLabel">Confirm Purchase</h5>
              </div>
              <div class="modal-body">
                Would you like to purchase <b><span id="shares"></span></b> share(s) of <b><span id="symbol"></span></b>?
              </div>
              <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                  <button id="confirmBtn" type="submit" class="btn btn-primary">Confirm</button>
              </div>
          </div>
      </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    $(document).ready(function() {
        $('#confirmModal').on('shown.bs.modal', function () {
            var symbol = document.getElementsByName("symbol")[0].value;
            var shares = document.getElementsByName("shares")[0].value;
            if (symbol.trim() === "") {
              symbol = "NO SYMBOL ENTERED";
            }
            if (shares.trim() === "") {
                shares = "NO SHARES ENTERED";
            }
            var modal = $(this);
            modal.find('.modal-body #symbol').text(symbol);
            modal.find('.modal-body #shares').text(shares);
        });

        $('#confirmBtn').click(function() {
            $('#buy-form').submit();
        });
    });
  </script>
{% endblock %}
